<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,initial-scale=0.5,target-densitydpi=device-dpi,user-scalable=no,minimum-scale=0.5, maximum-scale=0.5">
<title>2015羊年喜洋洋！</title>
<link rel="icon" href="happynewyear2015/assets/logo.ico" type="image/x-icon"/> 
<link rel="shortcut icon" href="happynewyear2015/assets/logo.ico" type="image/x-icon"/> 

<script src="happynewyear2015/js/easeljs-0.7.1.min.js"></script>
<script src="happynewyear2015/js/tweenjs-0.5.1.min.js"></script>
<script src="happynewyear2015/js/movieclip-0.7.1.min.js"></script>
<script src="happynewyear2015/js/canvas2image.js"></script>
<script src="happynewyear2015/js/jquery-1.7.1.min.js"></script>

<script src="happynewyear2015/js/card.js"></script>
<script src="happynewyear2015/js/isPC.js"></script>
<script src="happynewyear2015/js/initTools.js"></script>
<script src="happynewyear2015/js/draw.js"></script>
<script src="happynewyear2015/js/share.js"></script>
<script src="happynewyear2015/js/weixin.js"></script>

<script src="happynewyear2015/js/gbmaskthum.js"></script>
<script>
var canvas, stage, mc;
var sw,sh,sx;
var scaleNum;
var offset;
var leftLine;
var rightLine;
/*
* jwl1978_cn@sina.com
* v1.0
*/
function init() {
	sh=window.innerHeight;
	/*
	if(IsPC()==true){
		sw=Math.round(64*sh/85);
	}else{
		sw=window.innerWidth;
	}
	*/
	sw=Math.round(64*sh/85);//window.innerWidth;
	scaleNum=sh/850;

	sx=0;//parseInt((sw-640*scaleNum)/2);

	canvas = document.getElementById("canvas");
	stage = new createjs.Stage(canvas);
	stage.enableMouseOver(10);
	
	stage.canvas.width = canvas.width=sw;
	stage.canvas.height = canvas.height=sh;
	
	offset=(window.innerWidth-sw)/2;
	canvas.style.position="absolute";
	canvas.style.left=offset+"px";//(window.innerWidth-sw)/2+"px";
	
	var foo= document.getElementById("foo");
	foo.style.left=offset+"px";
	var loadImg=document.getElementById("loadImg");
	loadImg.style.left=offset+"px";
	
	mc = new lib.card();
	mc.scaleX=mc.scaleY=scaleNum;
	//mc.x=sx;
	
	initTools();
	stage.addChild(mc);
	stage.update();

	if(IsPC()==false){
		mc.share.gotoAndStop(1);
	}
	mc.share.visible=false;
	mc.share.alpha=0;
	mc.rect_bottom.alpha=mc.rect_top.alpha=mc.rect_left.alpha=mc.rect_right.alpha=mc.tools.alpha=mc.toolsBg.alpha=0;
	
	createjs.Touch.enable(stage,true,false);
	createjs.Ticker.setFPS(lib.properties.fps);
	createjs.Ticker.addEventListener("tick", stage);
}

function goTween()
{
	mc.diy.gotoAndPlay(1);
}

function goOnBg()
{
	mc.diy.bg2.gotoAndPlay(23);
}

function initReadme()
{
	mc.diy.readme.btn_diy.addEventListener("click", goDiyHandler);
}

function goDiyHandler()
{
	if(window.innerWidth<sw){
		var te=(sw-window.innerWidth)/2;
		//alert(te+":"+mc.rect_right.x+":"+scaleNum+":"+sw+":"+window.innerWidth);
		mc.rect_left.x=((((sw-window.innerWidth)/2)+5)/scaleNum)-1;//mc.rect_left.x+te;//58;//
		mc.rect_right.x=((sw-te)/scaleNum)-2.5;///window.innerWidth/scaleNum;//mc.rect_right.x-te; 582;
	}
	
	/*
	leftLine=new lib.rect_left();
	rightLine=new lib.rect_right();
	
	mc.addChild(leftLine,rightLine);
	leftLine.scaleX=rightLine.scaleX=scaleNum;
	leftLine.height=rightLine.height=sh;
	rightLine.x=sw-5*scaleNum;
	*/
	
	//mc.rect_right.x=mc.rect_right.x-te;
	
	mc.diy.readme.btn_diy.removeEventListener("click", goDiyHandler);
	mc.diy.gotoAndPlay(119);
	createjs.Tween.get(mc.rect_bottom).to({alpha:1}, 800);
	createjs.Tween.get(mc.rect_top).to({alpha:1}, 800);
	createjs.Tween.get(mc.rect_left).to({alpha:1}, 800);
	createjs.Tween.get(mc.rect_right).to({alpha:1}, 800);
	createjs.Tween.get(mc.tools).to({alpha:1}, 800);
	createjs.Tween.get(mc.toolsBg).to({alpha:1}, 800);
	initDraw();
}

function initDiy()
{
	mc.diy.alert2.visible=false;
	mc.diy.alert1.visible=false;
}

function backShare()
{
	mc.share.gotoAndStop(1);
}


</script>
</head>
<style type="text/css">
body {
	margin-left: 0pxy
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
	background-image: url('happynewyear2015/assets/bg.png'); 
	background-repeat: repeat-x repeat-y 
}
canvas { 
	display: block; 
}

</style>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" style="background-color:#A70022" onload="init();">
	<canvas id="canvas" width="640" height="850" style="background-color:#A70022"></canvas>
	<div id="loadImg" style="overflow:hidden;width:36px;position:absolute">
		<input type="file" id="imageLoader" name="imageLoader" value="" style="height:40px;background-color:transparent;opacity:0;cursor:pointer;"/>
	</div>
	<div id="foo" style="visibility:hidden;position:absolute">
		<input type="text" id="inputMsg" name="inputMsg" onkeydown="checkEnter(event)" onkeyup="checkEnter(event)" maxlength="15" value="" style="width:180px;height:25px;font-family:微软雅黑;border:1px;font-size:19px;background-color:transparent;opacity:0;cursor:pointer;"/>
	</div>
</body>
</html>